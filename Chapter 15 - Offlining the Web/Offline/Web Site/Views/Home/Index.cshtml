@using Web_Site.Models

<!DOCTYPE html>
@{
    
    if (HttpContext.Current.IsDebuggingEnabled) {
        @:<html lang="en">
    }
    else { 

        var appcacheFileTime = File.GetLastWriteTime(
                                Server.MapPath(@"default.appcache")).Ticks;
        var appCache = Href("~/default.appcache") + "?v=" + appcacheFileTime.ToString();
        @:<html lang="en" manifest="@appCache">
    
    }
        
        }
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Modern Web Movies</title>

    <meta content="This is a demonstration site for the Modern Web Movie Book. It is meant to serve as an example of how to build a modern single page web application." name="description">
    <meta content="Chris Love" name="author">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <link href="favicon.ico" rel="shortcut icon">
    <link href="img/h/apple-touch-icon.png" rel="apple-touch-icon-precomposed" sizes="114x114">
    <link href="img/m/apple-touch-icon.png" rel="apple-touch-icon-precomposed" sizes="72x72">
    <link href="img/l/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed">
    <link href="img/l/apple-touch-icon.png" rel="shortcut icon">

    <meta name="application-name" content="Love2Dev" />
    <meta name="msapplication-allowDomainMetaTags" content="true">

    <meta name="msapplication-config" content="http://love2dev.com/livetile.xml" />

    <meta name="msapplication-navbutton-color" content="#990000">

    <meta name="msapplication-TileColor" content="#000000" />
    <meta name="msapplication-TileImage" content="img/love2devlogo.png" />

    <meta name="msapplication-square70x70logo" content="img/tinylove2devlogo.png" />
    <meta name="msapplication-square150x150logo" content="img/love2devlogo.png" />
    <meta name="msapplication-wide310x150logo" content="img/310150love2devlogo.png" />
    <meta name="msapplication-square310x310logo" content="img/largelove2devlogo.png" />

    <meta name="msapplication-badge" content="frequency=1440; polling-uri=http://love2dev.com/polling">
    <meta name="msapplication-notification" content="frequency=1440;polling-uri=http://love2dev.com/polling; cycle=1" />

    <meta name="msapplication-starturl" content="#!">

    <meta name="msapplication-tooltip" content="Chris Love's Professional Web Development Blog">

    <meta content="name=Tags;action-uri=#!tags;icon-uri=./favicon.ico" name="msapplication-task">
    <meta content="name=Calendar;action-uri=#!calendar;icon-uri=./favicon.ico" name="msapplication-task">
    <meta content="name=Libraries;action-uri=#!libraries;icon-uri=./favicon.ico" name="msapplication-task">
    <meta content="name=Presentations;action-uri=#!presentations;icon-uri=./favicon.ico" name="msapplication-task">

    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">

    <meta name="google-site-verification" content="[verification key goes here]" />

    <link href="img/l/splash.png" rel="apple-touch-startup-image">
    <meta content="on" http-equiv="cleartype">

    <link href="css/debug/site.css?v=.2" rel="stylesheet">
    <link href="css/debug/movie-grid.css?v=.2" rel="stylesheet">
    <link href="css/debug/animations.css?v=.2" rel="stylesheet">
    <link href="css/debug/touch.css?v=.2" rel="stylesheet">
    <link href="css/debug/panorama.css?v=.2" rel="stylesheet">
    <link href="css/debug/toolbar.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.forms.css?v=.2" rel="stylesheet">
    <link href="css/debug/movie.app.nav.css?v=.2" rel="stylesheet">

    <link href="css/debug/movie.app.account-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.login-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.home-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.movie-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.movies-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.news-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.profile-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.search-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.theaters-view.css?v=.1" rel="stylesheet">
    <link href="css/debug/movie.app.maps-view.css?v=.1" rel="stylesheet">
</head>
<body>
    <header class="site-header" role="banner">
        <span class="win-backbutton"></span>
        <h1 class="view-title">Mobile Movies</h1>
        <nav class="main-nav" role="navigation">
            <a href="#!" role="menuitem" class="home-nav"><span class="nav-icon home-icon"></span><span class="nav-text">Home</span></a>
            <a href="#!theaters" role="menuitem" class="theaters-nav"><span class="nav-icon theaters-icon"></span><span class="nav-text">Theaters</span></a>
            <a href="#!maps" role="menuitem" class="maps-nav"><span class="nav-icon maps-icon"></span><span class="nav-text">Map</span></a>
            <a href="#!news" role="menuitem" class="news-nav"><span class="nav-icon news-icon"></span><span class="nav-text">News</span></a>
            <a href="#!search" role="menuitem" class="search-nav"><span class="nav-icon search-icon"></span><span class="nav-text">Search</span></a>
        </nav>
        <span class="hamburger-nav"><span class="hamburger-bar"></span><span class="hamburger-bar"></span><span class="hamburger-bar"></span></span>
    </header>
    <section id="main" class="main-content" role="main"></section>
    <footer class="toolbar">
        <nav class="toolbar-top-menu"></nav>
        <nav class="toolbar-sub-menu"></nav>
    </footer>

        @{
                
            DateTime dtNow = DateTime.Now;
            var cookieTTLMin = 0;
            var cookieTTLDay = 0;

            if (HttpContext.Current.IsDebuggingEnabled)
            {
                cookieTTLMin = 5;
            }
            else {
                cookieTTLDay = 30;
            }

            TimeSpan tsMinute = new TimeSpan(cookieTTLDay, 0, cookieTTLMin, 0);
            long lastLoad = DateTime.MinValue.ToUniversalTime().Ticks;
            var cookie = Request.Cookies["dt"];

            if (cookie == null)
            {

                cookie = new HttpCookie("dt");

                //Set the cookies value
                cookie.Value = DateTime.Now.ToUniversalTime().Ticks.ToString();

                cookie.Expires = dtNow + tsMinute;

                //Add the cookie
                Response.Cookies.Add(cookie);

            }
            else
            {
                lastLoad = long.Parse(cookie.Value);
            }

            //Set the cookies value
            cookie.Value = DateTime.Now.ToUniversalTime().Ticks.ToString();

            //Set the cookie to expire in 1 minute

            cookie.Expires = dtNow + tsMinute;
            
            var serverPath = Server.MapPath("");
            
            var views = new string[] {
                    serverPath + @"\Views\Home\home-view.cshtml",
                    serverPath + @"\Views\Home\account-view.cshtml",
                    serverPath + @"\Views\Home\login-view.cshtml",
                    serverPath + @"\Views\Home\maps-view.cshtml",
                    serverPath + @"\Views\Home\movie-view.cshtml",
                    serverPath + @"\Views\Home\movies-view.cshtml",
                    serverPath + @"\Views\Home\news-view.cshtml",
                    serverPath + @"\Views\Home\profile-view.cshtml",
                    serverPath + @"\Views\Home\search-view.cshtml",
                    serverPath + @"\Views\Home\theaters-view.cshtml",
                    serverPath + @"\Views\Home\_templates.cshtml"
            };
            
            @Html.RenderRequiredViews(lastLoad, views);
        
        }

        <script id="bing-map-script"  src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>


    <script src="@Href("~/js/libs/mbp.js?v=.01")"></script>
    <script src="@Href("~/js/libs/backpack.js?v=.1")"></script>
    <script src="@Href("~/js/libs/reqwest.min.js?v=.1")"></script>
    <script src="@Href("~/js/libs/rqdata.js?v=.1")"></script>
    <script src="@Href("~/js/libs/mustache.js?v=.1")"></script>
    <script src="@Href("~/js/libs/spa.js?v=.1")"></script>
    <script src="@Href("~/js/libs/deeptissue.js?v=.1")"></script>
    <script src="@Href("~/js/libs/panorama.js?v=.1")"></script>
    <script src="@Href("~/js/libs/toolbar.js?v=.1")"></script>

    <script src="@Href("~/js/debug/movie.app.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.api.js?v=.1")"></script>

    <script src="@Href("~/js/debug/movie.app.account-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.home-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.login-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.maps-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.news-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.profile-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.search-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.theaters-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.movie-view.js?v=.1")"></script>
    <script src="@Href("~/js/debug/movie.app.movies-view.js?v=.1")"></script>

    <script src="@Href("~/js/debug/movie.app.bootstrap.js?v=.1")"></script>

</body>
</html>
